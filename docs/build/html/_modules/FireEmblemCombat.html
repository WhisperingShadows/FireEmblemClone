<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>FireEmblemCombat &mdash; FireEmblemClone documentation</title>


    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/graphviz.css" type="text/css"/>


    <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
    <![endif]-->


    <script type="text/javascript" id="documentation_options" data-url_root="../"
            src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>

    <script type="text/javascript" src="../_static/js/theme.js"></script>


    <link rel="index" title="Index" href="../genindex.html"/>
    <link rel="search" title="Search" href="../search.html"/>
</head>

<body class="wy-body-for-nav">


<div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search">


                <a href="../index.html" class="icon icon-home" alt="Documentation Home"> FireEmblemClone


                </a>


                <div role="search">
                    <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
                        <input type="text" name="q" placeholder="Search docs"/>
                        <input type="hidden" name="check_keywords" value="yes"/>
                        <input type="hidden" name="area" value="default"/>
                    </form>
                </div>


            </div>


            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">


                <p class="caption"><span class="caption-text">Contents:</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../modules.html">FireEmblemClone</a></li>
                </ul>


            </div>

        </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


        <nav class="wy-nav-top" aria-label="top navigation">

            <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
            <a href="../index.html">FireEmblemClone</a>

        </nav>


        <div class="wy-nav-content">

            <div class="rst-content">


                <div role="navigation" aria-label="breadcrumbs navigation">

                    <ul class="wy-breadcrumbs">

                        <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>

                        <li><a href="index.html">Module code</a> &raquo;</li>

                        <li>FireEmblemCombat</li>


                        <li class="wy-breadcrumbs-aside">

                        </li>

                    </ul>


                    <hr/>
                </div>
                <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
                    <div itemprop="articleBody">

                        <h1>Source code for FireEmblemCombat</h1>
                        <div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">DijkstraAlgorithm_Speedy_Custom</span> <span class="kn">import</span> <span
                                class="o">*</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span
                                class="n">trunc</span><span class="p">,</span> <span class="n">floor</span>  <span
                                class="c1"># ceil</span>
<span class="kn">from</span> <span class="nn">FireEmblemLoadJsonDataFiles</span> <span class="kn">import</span> <span
                                class="n">load_files_kag_calc_ver</span>

<span class="c1"># FIXME: change casings</span>
<span class="n">CONFIG</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;combat_animations&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;off&quot;</span><span class="p">,</span>
    <span class="s2">&quot;support_animations&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;off&quot;</span><span class="p">,</span>
    <span class="s2">&quot;foe/ally autobattle movement&quot;</span><span class="p">:</span> <span class="s2">&quot;simple&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;auto-favorite&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;starting a map&quot;</span><span class="p">:</span> <span class="s2">&quot;go into battle&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;smart end&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;show danger area&quot;</span><span class="p">:</span> <span class="s2">&quot;off&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;confirm action&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="s2">&quot;confirm move&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="s2">&quot;double tap to wait&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;off&quot;</span><span class="p">,</span>
    <span class="s2">&quot;auto-battle button&quot;</span><span class="p">:</span> <span class="s2">&quot;all locations&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;assist skills in auto&quot;</span><span class="p">:</span> <span class="s2">&quot;no move skills&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;auto-battle text&quot;</span><span class="p">:</span> <span class="s2">&quot;auto-advance&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;continous auto&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;on&quot;</span><span class="p">,</span>
    <span class="s2">&quot;map: no animation&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;off&quot;</span><span class="p">,</span>
    <span class="s2">&quot;auto: no animation&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;off&quot;</span><span class="p">,</span>
    <span class="s2">&quot;forging bonds: skip conversation&quot;</span><span class="p">:</span> <span class="s2">&quot;off&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;asset/flaw color display&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;on&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sorting by level&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="s2">&quot;duo hero display&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;full&quot;</span><span class="p">,</span>
    <span class="s2">&quot;no duo skill animation&quot;</span><span class="p">:</span> <span
                                class="s2">&quot;off&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tt difficulty tip&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;lost lore home notification&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;mjolnir&#39;s strike home notification&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span
                                class="p">,</span>  <span
                                class="c1"># FIXME: change mjolnir to include diacritics</span>
    <span class="s2">&quot;voting gauntlet home notification&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;forging bonds home notification&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;compile CMs home notification&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;AR auto-dispatch home notification&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;enemy music&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;battle music&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;silent mode&quot;</span><span class="p">:</span> <span class="s2">&quot;off&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;BGM volume&quot;</span><span class="p">:</span> <span class="mi">6</span><span
                                class="p">,</span>
    <span class="s2">&quot;SE volume&quot;</span><span class="p">:</span> <span class="mi">5</span><span
                                class="p">,</span>
    <span class="s2">&quot;voice volume&quot;</span><span class="p">:</span> <span class="mi">0</span><span
                                class="p">,</span>
<span class="p">}</span>

<span class="n">data_assists</span><span class="p">,</span> <span class="n">data_driveskills</span><span
                                class="p">,</span> <span class="n">data_heroes</span><span class="p">,</span> <span
                                class="n">data_passives</span><span class="p">,</span> <span
                                class="n">data_specials</span><span class="p">,</span> <span
                                class="n">data_weapons</span><span class="p">,</span> <span
                                class="n">data_blessings</span><span class="p">,</span> \
<span class="n">data_refinements</span><span class="p">,</span> <span class="n">data_support_bonus</span> <span
                                class="o">=</span> <span class="n">load_files_kag_calc_ver</span><span
                                class="p">(</span><span class="n">get_assists</span><span class="o">=</span><span
                                class="kc">False</span><span class="p">,</span> <span
                                class="n">get_driveskills</span><span class="o">=</span><span
                                class="kc">False</span><span class="p">,</span>
                                                               <span class="n">get_passives</span><span
                                class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                               <span class="n">get_specials</span><span
                                class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">get_blessings</span><span
                                class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                               <span class="n">get_support_bonus</span><span
                                class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span
                                class="n">init_as_grid</span><span class="p">(</span><span class="mi">6</span><span
                                class="p">,</span> <span class="mi">8</span><span class="p">)</span>


<span class="c1"># print(grid.nodes)</span>

<div class="viewcode-block" id="get_distance_from_tuples"><a class="viewcode-back"
                                                             href="../FireEmblemCombat.html#FireEmblemCombat.get_distance_from_tuples">[docs]</a><span
        class="k">def</span> <span class="nf">get_distance_from_tuples</span><span class="p">(</span><span class="bp">self</span><span
        class="p">,</span> <span class="n">enemy</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">enemy</span><span
            class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span
            class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span
            class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">enemy</span><span
            class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span
            class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>


<span class="n">move_type_to_move_range</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Armored&quot;</span><span
                                class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                           <span class="s2">&quot;Infantry&quot;</span><span class="p">:</span> <span
                                class="mi">2</span><span class="p">,</span>
                           <span class="s2">&quot;Flier&quot;</span><span class="p">:</span> <span
                                class="mi">2</span><span class="p">,</span>
                           <span class="s2">&quot;Cavalry&quot;</span><span class="p">:</span> <span class="mi">3</span><span
                                class="p">}</span>

<span class="n">weapon_to_attack_range</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Sword&quot;</span><span
                                class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                          <span class="s2">&quot;Lance&quot;</span><span class="p">:</span> <span
                                class="mi">1</span><span class="p">,</span>
                          <span class="s2">&quot;Axe&quot;</span><span class="p">:</span> <span class="mi">1</span><span
                                class="p">,</span>
                          <span class="s2">&quot;Breath&quot;</span><span class="p">:</span> <span
                                class="mi">1</span><span class="p">,</span>
                          <span class="s2">&quot;Beast&quot;</span><span class="p">:</span> <span
                                class="mi">1</span><span class="p">,</span>
                          <span class="s2">&quot;Bow&quot;</span><span class="p">:</span> <span class="mi">2</span><span
                                class="p">,</span>
                          <span class="s2">&quot;Red Tome&quot;</span><span class="p">:</span> <span class="mi">2</span><span
                                class="p">,</span>
                          <span class="s2">&quot;Blue Tome&quot;</span><span class="p">:</span> <span
                                class="mi">2</span><span class="p">,</span>
                          <span class="s2">&quot;Green Tome&quot;</span><span class="p">:</span> <span
                                class="mi">2</span><span class="p">,</span>
                          <span class="s2">&quot;Dagger&quot;</span><span class="p">:</span> <span
                                class="mi">2</span><span class="p">,</span>
                          <span class="s2">&quot;Staff&quot;</span><span class="p">:</span> <span
                                class="mi">2</span><span class="p">}</span>


<div class="viewcode-block" id="pos"><a class="viewcode-back" href="../FireEmblemCombat.html#FireEmblemCombat.pos">[docs]</a><span
        class="k">def</span> <span class="nf">pos</span><span class="p">(</span><span class="n">expr</span><span
        class="p">):</span>
    <span class="k">if</span> <span class="n">expr</span> <span class="o">&lt;</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">expr</span></div>


<div class="viewcode-block" id="neg"><a class="viewcode-back" href="../FireEmblemCombat.html#FireEmblemCombat.neg">[docs]</a><span
        class="k">def</span> <span class="nf">neg</span><span class="p">(</span><span class="n">expr</span><span
        class="p">):</span>
    <span class="k">if</span> <span class="n">expr</span> <span class="o">&gt;</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">expr</span></div>


<span class="n">weapon_advantage</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Red&quot;</span><span class="p">:</span> <span class="s2">&quot;Green&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;Blue&quot;</span><span class="p">:</span> <span class="s2">&quot;Red&quot;</span><span
                                class="p">,</span>
    <span class="s2">&quot;Green&quot;</span><span class="p">:</span> <span class="s2">&quot;Blue&quot;</span>
<span class="p">}</span>


<span class="c1">#</span>
<span class="c1"># class Weapon:</span>
<span class="c1">#     def __init__(self, name=&quot;None&quot;, color=None, weapon_type=None, might=0, damage_type=None, sp=0, exclusive=False,</span>
<span class="c1">#                  desc=&quot;&quot;):</span>
<span class="c1">#         for k, v in [_ for _ in locals().items()][::-1]:</span>
<span class="c1">#             setattr(self, k, v)</span>
<span class="c1">#         self.range = weapon_to_attack_range[weapon_type]</span>


<div class="viewcode-block" id="Weapon"><a class="viewcode-back"
                                           href="../FireEmblemCombat.html#FireEmblemCombat.Weapon">[docs]</a><span
        class="k">class</span> <span class="nc">Weapon</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span
            class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># print(kwargs)</span>
        <span class="k">if</span> <span class="s2">&quot;input_dict&quot;</span> <span class="ow">in</span> <span
            class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span
            class="s1">&#39;input_dict&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span
            class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span
            class="n">kwargs</span><span class="p">]:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span
            class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span
            class="n">key</span><span class="p">])</span>

<div class="viewcode-block" id="Weapon.from_dict"><a class="viewcode-back"
                                                     href="../FireEmblemCombat.html#FireEmblemCombat.Weapon.from_dict">[docs]</a>    <span
        class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span
            class="p">,</span> <span class="n">input_dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span
            class="n">input_dict</span><span class="o">=</span><span class="n">input_dict</span><span class="p">)</span></div></div>


<span class="c1">#</span>
<span class="c1"># weapons = {</span>
<span class="c1">#     &quot;Iron Sword&quot;: Weapon(&quot;Iron Sword&quot;, &quot;red&quot;, &quot;Sword&quot;, 6, &quot;physical&quot;, 50, False),</span>
<span class="c1">#     &quot;Iron Lance&quot;: Weapon(&quot;Iron Lance&quot;, &quot;blue&quot;, &quot;Lance&quot;, 6, &quot;physical&quot;, 50, False),</span>
<span class="c1">#     &quot;Iron Axe&quot;: Weapon(&quot;Iron Axe&quot;, &quot;green&quot;, &quot;Axe&quot;, 6, &quot;physical&quot;, 50, False),</span>
<span class="c1">#     &quot;Fire&quot;: Weapon(&quot;Fire&quot;, &quot;red&quot;, &quot;Tome&quot;, 4, &quot;magical&quot;, 50, False),</span>
<span class="c1">#     &quot;Light&quot;: Weapon(&quot;Light&quot;, &quot;blue&quot;, &quot;Tome&quot;, 4, &quot;magical&quot;, 50, False),</span>
<span class="c1">#     &quot;Wind&quot;: Weapon(&quot;Wind&quot;, &quot;green&quot;, &quot;Tome&quot;, 4, &quot;magical&quot;, 50, False),</span>
<span class="c1"># }</span>

<span class="n">weapons</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">weapon</span> <span class="ow">in</span> <span
                                class="n">data_weapons</span><span class="p">:</span>
    <span class="c1"># print(data_weapons[weapon])</span>
    <span class="c1"># print(len(data_weapons[weapon]))</span>
    <span class="n">weapons</span><span class="p">[</span><span class="n">weapon</span><span class="p">]</span> <span
                                class="o">=</span> <span class="n">Weapon</span><span class="o">.</span><span class="n">from_dict</span><span
                                class="p">(</span><span class="n">data_weapons</span><span class="p">[</span><span
                                class="n">weapon</span><span class="p">])</span>

    <span class="c1"># print(classWeapon)</span>
    <span class="c1"># print(classWeapon.name)</span>


<span class="c1"># classWeapon = Weapon(name = &quot;My name&quot;)</span>
<span class="c1"># print(classWeapon)</span>
<span class="c1"># print(classWeapon.name)</span>


<span class="c1"># TODO: Overhaul for compatibility with data from FireEmblemLoadJsonDataFiles.load_files()</span>
<div class="viewcode-block" id="Character"><a class="viewcode-back"
                                              href="../FireEmblemCombat.html#FireEmblemCombat.Character">[docs]</a><span
        class="k">class</span> <span class="nc">Character</span><span class="p">(</span><span
        class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span
            class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">HP</span><span
            class="p">,</span> <span class="n">ATK</span><span class="p">,</span> <span class="n">SPD</span><span
            class="p">,</span> <span class="n">DEF</span><span class="p">,</span> <span class="n">RES</span><span
            class="p">,</span> <span class="n">weapon_type</span><span class="o">=</span><span class="s2">&quot;Sword&quot;</span><span
            class="p">,</span> <span class="n">color</span><span class="o">=</span><span
            class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span
            class="kc">None</span><span class="p">,</span> <span class="n">move_type</span><span class="o">=</span><span
            class="s2">&quot;Infantry&quot;</span><span class="p">,</span>
                 <span class="n">move_range</span><span class="o">=</span><span class="kc">None</span><span
            class="p">,</span> <span class="n">weapon</span><span class="o">=</span><span class="kc">None</span><span
            class="p">,</span> <span class="n">affinity</span><span class="o">=</span><span class="mi">0</span><span
            class="p">):</span>

        <span class="c1"># print([k for k in locals().items()][::-1])</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span
            class="ow">in</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span
            class="n">_</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span><span
            class="o">.</span><span class="n">items</span><span class="p">()][::</span><span class="o">-</span><span
            class="mi">1</span><span class="p">]:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span
            class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span
            class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span
            class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">nodes</span><span
            class="p">[</span><span class="n">grid</span><span class="o">.</span><span
            class="n">get_index_from_xy</span><span class="p">(</span><span class="n">pos</span><span
            class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span
            class="n">holds</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="n">move_range</span> <span class="ow">is</span> <span
            class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_range</span> <span
            class="o">=</span> <span class="n">move_type_to_move_range</span><span class="p">[</span><span class="bp">self</span><span
            class="o">.</span><span class="n">move_type</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span
            class="n">weapon_to_attack_range</span><span class="p">[</span><span class="bp">self</span><span
            class="o">.</span><span class="n">weapon_type</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">weapon</span> <span class="ow">is</span> <span
            class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">equip_weapon</span><span
            class="p">(</span><span class="n">weapon</span><span class="p">)</span>

<div class="viewcode-block" id="Character.create_from_json"><a class="viewcode-back"
                                                               href="../FireEmblemCombat.html#FireEmblemCombat.Character.create_from_json">[docs]</a>    <span
        class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create_from_json</span><span class="p">(</span><span
            class="bp">cls</span><span class="p">,</span> <span class="n">hero_name</span><span class="p">):</span>
        <span class="n">hero</span> <span class="o">=</span> <span class="n">data_heroes</span><span
            class="p">[</span><span class="n">hero_name</span><span class="p">]</span>
        <span class="n">hero_stats</span> <span class="o">=</span> <span class="n">hero</span><span
            class="p">[</span><span class="s2">&quot;base_stat&quot;</span><span class="p">][</span><span class="s2">&quot;star_5&quot;</span><span
            class="p">]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span
            class="n">name</span><span class="o">=</span><span class="n">hero</span><span class="p">[</span><span
            class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">HP</span><span
            class="o">=</span><span class="n">hero_stats</span><span class="p">[</span><span
            class="s2">&quot;hp&quot;</span><span class="p">],</span> <span class="n">ATK</span><span class="o">=</span><span
            class="n">hero_stats</span><span class="p">[</span><span class="s2">&quot;atk&quot;</span><span
            class="p">],</span> <span class="n">SPD</span><span class="o">=</span><span class="n">hero_stats</span><span
            class="p">[</span><span class="s2">&quot;spd&quot;</span><span class="p">],</span>
                   <span class="n">DEF</span><span class="o">=</span><span class="n">hero_stats</span><span
            class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">],</span>
                   <span class="n">RES</span><span class="o">=</span><span class="n">hero_stats</span><span
            class="p">[</span><span class="s2">&quot;res&quot;</span><span class="p">],</span> <span class="n">weapon_type</span><span
            class="o">=</span><span class="n">hero</span><span class="p">[</span><span class="s2">&quot;weapon_type&quot;</span><span
            class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">hero</span><span
            class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
                   <span class="n">move_type</span><span class="o">=</span><span class="n">hero</span><span
            class="p">[</span><span class="s2">&quot;move_type&quot;</span><span class="p">],</span> <span class="n">weapon</span><span
            class="o">=</span><span class="n">weapons</span><span class="p">[</span><span class="n">hero</span><span
            class="p">[</span><span class="s2">&quot;weapon&quot;</span><span class="p">][</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]])</span></div>

<div class="viewcode-block" id="Character.equip_weapon"><a class="viewcode-back"
                                                           href="../FireEmblemCombat.html#FireEmblemCombat.Character.equip_weapon">[docs]</a>    <span
        class="k">def</span> <span class="nf">equip_weapon</span><span class="p">(</span><span
        class="bp">self</span><span class="p">,</span> <span class="n">weapon</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">weapon</span><span class="o">.</span><span
            class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span
            class="n">weapon_type</span> <span class="ow">and</span> <span class="n">weapon</span><span
            class="o">.</span><span class="n">color</span> <span class="o">==</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">color</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">weapon</span> <span
            class="o">=</span> <span class="n">weapon</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ATK</span> <span class="o">=</span> <span
            class="bp">self</span><span class="o">.</span><span class="n">ATK</span> <span class="o">+</span> <span
            class="n">weapon</span><span class="o">.</span><span class="n">might</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span
            class="s2">&quot;Incompatible weapon&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span
            class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span
            class="s2">&quot;Oh boy an error!&quot;</span><span class="p">,</span> <span class="n">e</span><span
            class="p">)</span></div>

<div class="viewcode-block" id="Character.unequip_weapon"><a class="viewcode-back"
                                                             href="../FireEmblemCombat.html#FireEmblemCombat.Character.unequip_weapon">[docs]</a>    <span
        class="k">def</span> <span class="nf">unequip_weapon</span><span class="p">(</span><span
        class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span
            class="n">weapon</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ATK</span> <span
            class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ATK</span> <span
            class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">weapon</span><span
            class="o">.</span><span class="n">might</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weapon</span> <span
            class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Character.get_distance"><a class="viewcode-back"
                                                           href="../FireEmblemCombat.html#FireEmblemCombat.Character.get_distance">[docs]</a>    <span
        class="k">def</span> <span class="nf">get_distance</span><span class="p">(</span><span
        class="bp">self</span><span class="p">,</span> <span class="n">enemy</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span
            class="n">enemy</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span
            class="p">])</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span
            class="n">enemy</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span
            class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span
            class="p">])</span></div>

<div class="viewcode-block" id="Character.calc_weapon_triangle"><a class="viewcode-back"
                                                                   href="../FireEmblemCombat.html#FireEmblemCombat.Character.calc_weapon_triangle">[docs]</a>    <span
        class="k">def</span> <span class="nf">calc_weapon_triangle</span><span class="p">(</span><span
        class="bp">self</span><span class="p">,</span> <span class="n">enemy</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">enemy</span><span class="o">.</span><span class="n">color</span> <span
            class="o">==</span> <span class="n">weapon_advantage</span><span class="p">[</span><span
            class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mf">0.2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span
            class="n">color</span> <span class="o">==</span> <span class="n">weapon_advantage</span><span
            class="p">[</span><span class="n">enemy</span><span class="o">.</span><span class="n">color</span><span
            class="p">]:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mf">0.2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span
            class="n">color</span> <span class="o">==</span> <span class="n">enemy</span><span class="o">.</span><span
            class="n">color</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span
            class="n">color</span> <span class="o">==</span> <span class="s2">&quot;gray&quot;</span> <span class="ow">or</span> <span
            class="n">enemy</span><span class="o">.</span><span class="n">color</span> <span class="o">==</span> <span
            class="s2">&quot;gray&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Character.calc_effectiveness"><a class="viewcode-back"
                                                                 href="../FireEmblemCombat.html#FireEmblemCombat.Character.calc_effectiveness">[docs]</a>    <span
        class="k">def</span> <span class="nf">calc_effectiveness</span><span class="p">(</span><span
        class="bp">self</span><span class="p">,</span> <span class="n">enemy</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weapon</span><span
            class="o">.</span><span class="n">type</span> <span class="o">==</span> <span
            class="s2">&quot;Bow&quot;</span> <span class="ow">and</span> <span class="n">enemy</span><span
            class="o">.</span><span class="n">move_type</span> <span class="o">==</span> <span class="s2">&quot;Flier&quot;</span><span
            class="p">:</span>
            <span class="k">return</span> <span class="mf">1.5</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Character.calc_boosted_damage"><a class="viewcode-back"
                                                                  href="../FireEmblemCombat.html#FireEmblemCombat.Character.calc_boosted_damage">[docs]</a>    <span
        class="k">def</span> <span class="nf">calc_boosted_damage</span><span class="p">(</span><span
        class="bp">self</span><span class="p">,</span> <span class="n">enemy</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span></div>
        <span class="c1"># TODO: add functionality</span>

<div class="viewcode-block" id="Character.attack_enemy"><a class="viewcode-back"
                                                           href="../FireEmblemCombat.html#FireEmblemCombat.Character.attack_enemy">[docs]</a>    <span
        class="k">def</span> <span class="nf">attack_enemy</span><span class="p">(</span><span
        class="bp">self</span><span class="p">,</span> <span class="n">enemy</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">enemy</span><span class="o">.</span><span class="n">pos</span> <span
            class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span
            class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You can&#39;t attack yourself silly&quot;</span><span
            class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">enemy</span><span class="o">.</span><span class="n">HP</span> <span
            class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span
            class="n">get_distance</span><span class="p">(</span><span class="n">enemy</span><span
            class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span
            class="n">range</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enemy in range, commencing attack&quot;</span><span
            class="p">)</span>
                <span class="n">mitigation</span> <span class="o">=</span> <span class="n">enemy</span><span
            class="o">.</span><span class="n">DEF</span> <span class="k">if</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">weapon</span><span class="o">.</span><span class="n">magical</span> <span
            class="o">==</span> <span class="s2">&quot;false&quot;</span> <span class="k">else</span> <span class="n">enemy</span><span
            class="o">.</span><span class="n">RES</span>

                <span class="n">damage</span> <span class="o">=</span> <span class="n">pos</span><span
            class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span
            class="o">.</span><span class="n">ATK</span> <span class="o">*</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">calc_effectiveness</span><span class="p">(</span><span
            class="n">enemy</span><span class="p">))</span> <span class="o">+</span> <span class="n">trunc</span><span
            class="p">(</span>
                    <span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span
            class="o">.</span><span class="n">ATK</span> <span class="o">*</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">calc_effectiveness</span><span class="p">(</span><span
            class="n">enemy</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span
            class="bp">self</span><span class="o">.</span><span class="n">calc_weapon_triangle</span><span
            class="p">(</span><span class="n">enemy</span><span class="p">)</span> <span class="o">*</span> <span
            class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">affinity</span> <span
            class="o">+</span> <span class="mi">20</span><span class="p">)</span> <span class="o">/</span> <span
            class="mi">20</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">calc_boosted_damage</span><span class="p">(</span><span
            class="n">enemy</span><span class="p">)</span> <span class="o">-</span> <span
            class="n">mitigation</span><span class="p">)</span>
                <span class="n">enemy</span><span class="o">.</span><span class="n">HP</span> <span
            class="o">=</span> <span class="n">enemy</span><span class="o">.</span><span class="n">HP</span> <span
            class="o">-</span> <span class="n">damage</span>

                <span class="k">if</span> <span class="n">enemy</span><span class="o">.</span><span class="n">HP</span> <span
            class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span
            class="o">.</span><span class="n">name</span><span class="p">,</span> <span
            class="s2">&quot;dealt&quot;</span><span class="p">,</span> <span class="n">damage</span><span
            class="p">,</span> <span class="s2">&quot;damage,&quot;</span><span class="p">,</span> <span
            class="n">enemy</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span
            class="s2">&quot;has&quot;</span><span class="p">,</span> <span class="n">enemy</span><span
            class="o">.</span><span class="n">HP</span><span class="p">,</span> <span class="s2">&quot;HP remaining&quot;</span><span
            class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span
            class="o">.</span><span class="n">name</span><span class="p">,</span> <span
            class="s2">&quot;dealt&quot;</span><span class="p">,</span> <span class="n">damage</span><span
            class="p">,</span> <span class="s2">&quot;damage,&quot;</span><span class="p">,</span> <span
            class="n">enemy</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span
            class="s2">&quot;has been defeated&quot;</span><span class="p">)</span>
                    <span class="n">grid</span><span class="o">.</span><span class="n">nodes</span><span
            class="p">[</span><span class="n">grid</span><span class="o">.</span><span
            class="n">get_index_from_xy</span><span class="p">(</span><span class="n">enemy</span><span
            class="o">.</span><span class="n">pos</span><span class="p">)]</span><span class="o">.</span><span
            class="n">holds</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="nb">print</span><span class="p">(</span><span
            class="s2">&quot;Enemy not in range&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enemy has already been defeated&quot;</span><span
            class="p">)</span></div>

<div class="viewcode-block" id="Character.attack_node"><a class="viewcode-back"
                                                          href="../FireEmblemCombat.html#FireEmblemCombat.Character.attack_node">[docs]</a>    <span
        class="k">def</span> <span class="nf">attack_node</span><span class="p">(</span><span
        class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="n">enemy</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span
            class="n">nodes</span><span class="p">[</span><span class="n">grid</span><span class="o">.</span><span
            class="n">get_index_from_xy</span><span class="p">(</span><span class="n">node</span><span
            class="p">)]</span><span class="o">.</span><span class="n">holds</span>
        <span class="k">if</span> <span class="n">enemy</span> <span class="ow">is</span> <span
            class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_enemy</span><span
            class="p">(</span><span class="n">enemy</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There is no enemy at position&quot;</span><span
            class="p">,</span> <span class="n">node</span><span class="p">)</span></div>

<div class="viewcode-block" id="Character.move"><a class="viewcode-back"
                                                   href="../FireEmblemCombat.html#FireEmblemCombat.Character.move">[docs]</a>    <span
        class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span
        class="p">,</span> <span class="n">new_pos</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span
            class="n">name</span><span class="p">,</span> <span class="s2">&quot;moved&quot;</span><span
            class="p">,</span> <span class="n">get_distance_from_tuples</span><span class="p">(</span><span class="bp">self</span><span
            class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">new_pos</span><span
            class="p">),</span> <span class="s2">&quot;spaces from&quot;</span><span class="p">,</span> <span
            class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span
            class="s2">&quot;to&quot;</span><span class="p">,</span> <span class="n">new_pos</span><span
            class="p">)</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span
            class="n">grid</span><span class="o">.</span><span class="n">get_index_from_xy</span><span
            class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span
            class="p">)]</span><span class="o">.</span><span class="n">holds</span> <span class="o">=</span> <span
            class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span
            class="n">new_pos</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span
            class="n">grid</span><span class="o">.</span><span class="n">get_index_from_xy</span><span
            class="p">(</span><span class="n">new_pos</span><span class="p">)]</span><span class="o">.</span><span
            class="n">holds</span> <span class="o">=</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Character.fight"><a class="viewcode-back"
                                                    href="../FireEmblemCombat.html#FireEmblemCombat.Character.fight">[docs]</a>    <span
        class="k">def</span> <span class="nf">fight</span><span class="p">(</span><span class="bp">self</span><span
        class="p">,</span> <span class="n">enemy</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attack_enemy</span><span
            class="p">(</span><span class="n">enemy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">enemy</span><span class="o">.</span><span class="n">HP</span> <span
            class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enemy</span><span class="o">.</span><span class="n">attack_enemy</span><span
            class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span
            class="n">SPD</span> <span class="o">&gt;=</span> <span class="n">enemy</span><span class="o">.</span><span
            class="n">SPD</span> <span class="o">+</span> <span class="mi">5</span> <span class="ow">and</span> <span
            class="bp">self</span><span class="o">.</span><span class="n">HP</span> <span class="o">&gt;</span> <span
            class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attack_enemy</span><span
            class="p">(</span><span class="n">enemy</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">enemy</span><span class="o">.</span><span
            class="n">SPD</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span
            class="n">SPD</span> <span class="o">+</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">enemy</span><span class="o">.</span><span class="n">attack_enemy</span><span
            class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Character.move_to_attack"><a class="viewcode-back"
                                                             href="../FireEmblemCombat.html#FireEmblemCombat.Character.move_to_attack">[docs]</a>    <span
        class="k">def</span> <span class="nf">move_to_attack</span><span class="p">(</span><span
        class="bp">self</span><span class="p">,</span> <span class="n">enemy</span><span class="p">):</span>
        <span class="n">endpoints</span> <span class="o">=</span> <span class="n">grid</span><span
            class="o">.</span><span class="n">dijkstra</span><span class="p">(</span><span class="n">enemy</span><span
            class="o">.</span><span class="n">pos</span><span class="p">,</span> <span
            class="n">eval_to_length</span><span class="o">=</span><span class="bp">self</span><span
            class="o">.</span><span class="n">range</span><span class="p">)</span>

        <span class="c1"># pprint([(weight, [n.data for n in node]) for (weight, node) in endpoints])</span>

        <span class="n">endpoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span
            class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
                     <span class="p">[</span><span class="n">points</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span
            class="n">get_distance_from_tuples</span><span class="p">(</span><span class="n">enemy</span><span
            class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">points</span><span
            class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span
            class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span
            class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="k">else</span> <span
            class="kc">None</span> <span class="k">for</span>
                      <span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">points</span><span
            class="p">)</span> <span class="ow">in</span> <span class="n">endpoints</span><span class="p">]</span> <span
            class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span
            class="kc">None</span><span class="p">]</span>

        <span class="c1"># pprint([i.data if i is not None else None for i in endpoints])</span>

        <span class="n">endpoints</span> <span class="o">=</span> <span class="p">[</span><span
            class="n">endpoint</span> <span class="k">for</span> <span class="n">endpoint</span> <span
            class="ow">in</span> <span class="n">endpoints</span> <span class="k">if</span>
                     <span class="n">get_distance_from_tuples</span><span class="p">(</span><span class="bp">self</span><span
            class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">endpoint</span><span
            class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;=</span> <span
            class="bp">self</span><span class="o">.</span><span class="n">move_range</span><span class="p">]</span>

        <span class="c1"># print([endpoint.data for endpoint in endpoints])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span
            class="n">endpoints</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span
            class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No available moves that can target&quot;</span><span
            class="p">,</span> <span class="n">enemy</span><span class="o">.</span><span class="n">name</span><span
            class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">endpoint</span> <span class="o">=</span> <span class="n">endpoints</span><span
            class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Chose position&quot;</span><span
            class="p">,</span> <span class="n">endpoint</span><span class="o">.</span><span class="n">data</span><span
            class="p">,</span> <span class="s2">&quot;from possible positions&quot;</span><span class="p">,</span> <span
            class="p">[</span><span class="n">endpoint</span><span class="o">.</span><span class="n">data</span> <span
            class="k">for</span> <span class="n">endpoint</span> <span class="ow">in</span> <span
            class="n">endpoints</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">endpoint</span><span class="o">.</span><span class="n">data</span> <span
            class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span
            class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span
            class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;stays where they are and attacks&quot;</span><span
            class="p">,</span> <span class="n">enemy</span><span class="o">.</span><span class="n">name</span><span
            class="p">,</span> <span class="s2">&quot;at position&quot;</span><span class="p">,</span> <span class="n">enemy</span><span
            class="o">.</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span
            class="o">.</span><span class="n">name</span><span class="p">,</span> <span
            class="s2">&quot;moves to&quot;</span><span class="p">,</span> <span class="n">endpoint</span><span
            class="o">.</span><span class="n">data</span><span class="p">,</span> <span
            class="s2">&quot;to attack&quot;</span><span class="p">,</span> <span class="n">enemy</span><span class="o">.</span><span
            class="n">name</span><span class="p">,</span> <span class="s2">&quot;at position&quot;</span><span
            class="p">,</span> <span class="n">enemy</span><span class="o">.</span><span class="n">pos</span><span
            class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span
            class="p">(</span><span class="n">endpoint</span><span class="o">.</span><span class="n">data</span><span
            class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">fight</span><span
            class="p">(</span><span class="n">enemy</span><span class="p">)</span></div>

<div class="viewcode-block" id="Character.move_towards"><a class="viewcode-back"
                                                           href="../FireEmblemCombat.html#FireEmblemCombat.Character.move_towards">[docs]</a>    <span
        class="k">def</span> <span class="nf">move_towards</span><span class="p">(</span><span
        class="bp">self</span><span class="p">,</span> <span class="n">enemy</span><span class="p">):</span>
        <span class="n">weight</span><span class="p">,</span> <span class="n">nodes</span> <span
            class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">dijkstra</span><span
            class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span
            class="p">,</span> <span class="n">enemy</span><span class="o">.</span><span class="n">pos</span><span
            class="p">,</span> <span class="n">only_end</span><span class="o">=</span><span class="kc">True</span><span
            class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">distance</span> <span class="o">=</span> <span class="n">get_distance_from_tuples</span><span
            class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span
            class="p">,</span> <span class="n">enemy</span><span class="o">.</span><span class="n">pos</span><span
            class="p">)</span>

        <span class="k">if</span> <span class="n">distance</span> <span class="o">==</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">range</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span
            class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;is already in range and does not move&quot;</span><span
            class="p">)</span>

        <span class="k">if</span> <span class="n">distance</span> <span class="o">&gt;</span> <span
            class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">:</span>
            <span class="n">move_distance</span> <span class="o">=</span> <span class="n">distance</span> <span
            class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span>
            <span class="k">if</span> <span class="n">move_distance</span> <span class="o">&gt;</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">move_range</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span
            class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="bp">self</span><span
            class="o">.</span><span class="n">move_range</span><span class="p">]</span><span class="o">.</span><span
            class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span
            class="p">(</span><span class="n">nodes</span><span class="p">[</span><span
            class="n">move_distance</span><span class="p">]</span><span class="o">.</span><span
            class="n">data</span><span class="p">)</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span
            class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span
            class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;is too close and moves further away&quot;</span><span
            class="p">)</span></div></div>


<span class="c1"># TODO: add proper AI</span>
<div class="viewcode-block" id="Enemy"><a class="viewcode-back" href="../FireEmblemCombat.html#FireEmblemCombat.Enemy">[docs]</a><span
        class="k">class</span> <span class="nc">Enemy</span><span class="p">(</span><span
        class="n">Character</span><span class="p">):</span>
    <span class="c1"># def __init__(self, *args, **kwargs):</span>
    <span class="c1">#     super().__init__(*args, **kwargs)</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="Player"><a class="viewcode-back"
                                           href="../FireEmblemCombat.html#FireEmblemCombat.Player">[docs]</a><span
        class="k">class</span> <span class="nc">Player</span><span class="p">(</span><span
        class="n">Character</span><span class="p">):</span>
    <span class="k">pass</span></div>


<span class="c1"># for i in dir(grid.nodes[0]):</span>
<span class="c1">#     print(i, grid.nodes[0].__getattribute__(i))</span>

<div class="viewcode-block" id="print_grid"><a class="viewcode-back"
                                               href="../FireEmblemCombat.html#FireEmblemCombat.print_grid">[docs]</a><span
        class="k">def</span> <span class="nf">print_grid</span><span class="p">(</span><span class="n">grid</span><span
        class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">grid</span><span
            class="o">.</span><span class="n">get_grid_width_height</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">iy</span> <span class="ow">in</span> <span
            class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span
            class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">)):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span
            class="n">x</span><span class="p">):</span>
            <span class="n">held</span> <span class="o">=</span> <span class="n">grid</span><span
            class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">iy</span> <span
            class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ix</span><span
            class="p">]</span><span class="o">.</span><span class="n">holds</span>
            <span class="k">if</span> <span class="n">held</span> <span class="o">==</span> <span class="kc">None</span><span
            class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span
            class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">held</span><span class="o">.</span><span
            class="vm">__class__</span> <span class="o">==</span> <span class="n">Enemy</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span
            class="p">(</span><span class="s2">&quot;x &quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">held</span><span class="o">.</span><span
            class="vm">__class__</span> <span class="o">==</span> <span class="n">Player</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span
            class="p">(</span><span class="s2">&quot;O &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span></div>


<div class="viewcode-block" id="enemy_phase"><a class="viewcode-back"
                                                href="../FireEmblemCombat.html#FireEmblemCombat.enemy_phase">[docs]</a><span
        class="k">def</span> <span class="nf">enemy_phase</span><span class="p">(</span><span
        class="n">enemies</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="swap_phase"><a class="viewcode-back"
                                               href="../FireEmblemCombat.html#FireEmblemCombat.swap_phase">[docs]</a><span
        class="k">def</span> <span class="nf">swap_phase</span><span class="p">(</span><span
        class="n">players</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="player_phase"><a class="viewcode-back"
                                                 href="../FireEmblemCombat.html#FireEmblemCombat.player_phase">[docs]</a><span
        class="k">def</span> <span class="nf">player_phase</span><span class="p">(</span><span
        class="n">players</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">CONFIG</span><span class="p">[</span><span class="s2">&quot;starting a map&quot;</span><span
            class="p">]</span> <span class="o">==</span> <span class="s2">&quot;swap spaces&quot;</span><span class="p">:</span>
        <span class="n">swap_phase</span><span class="p">(</span><span class="n">players</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span
            class="n">players</span><span class="p">():</span>
        <span class="n">select_action</span><span class="p">()</span></div>


<div class="viewcode-block" id="battle_phase"><a class="viewcode-back"
                                                 href="../FireEmblemCombat.html#FireEmblemCombat.battle_phase">[docs]</a><span
        class="k">def</span> <span class="nf">battle_phase</span><span class="p">(</span><span
        class="n">characters</span><span class="p">):</span>
    <span class="n">players</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">enemies</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span
            class="n">characters</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span
            class="n">character</span><span class="p">,</span> <span class="n">Player</span><span class="p">):</span>
            <span class="n">players</span><span class="o">.</span><span class="n">add</span><span
            class="p">(</span><span class="n">character</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span
            class="n">character</span><span class="p">,</span> <span class="n">Enemy</span><span class="p">):</span>
            <span class="n">enemies</span><span class="o">.</span><span class="n">add</span><span
            class="p">(</span><span class="n">character</span><span class="p">)</span>

    <span class="n">player_phase</span><span class="p">(</span><span class="n">players</span><span class="p">)</span>

    <span class="n">enemy_phase</span><span class="p">(</span><span class="n">enemies</span><span class="p">)</span>

    <span class="k">pass</span></div>


<div class="viewcode-block" id="select_action"><a class="viewcode-back"
                                                  href="../FireEmblemCombat.html#FireEmblemCombat.select_action">[docs]</a><span
        class="k">def</span> <span class="nf">select_action</span><span class="p">():</span>
    <span class="c1"># actions: attack / move to attack, heal, stay, rally assist, movement skill</span>
    <span class="c1"># select action logic here</span>
    <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;attack&quot;</span>
    <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;attack&quot;</span><span
            class="p">:</span>
        <span class="n">opponent</span> <span class="o">=</span> <span class="n">select_enemy</span><span
            class="p">()</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="select_enemy"><a class="viewcode-back"
                                                 href="../FireEmblemCombat.html#FireEmblemCombat.select_enemy">[docs]</a><span
        class="k">def</span> <span class="nf">select_enemy</span><span class="p">():</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="program_instructions"><a class="viewcode-back"
                                                         href="../FireEmblemCombat.html#FireEmblemCombat.program_instructions">[docs]</a><span
        class="k">def</span> <span class="nf">program_instructions</span><span class="p">():</span>
    <span class="n">Char</span> <span class="o">=</span> <span class="n">Player</span><span class="p">(</span><span
            class="s2">&quot;Steve&quot;</span><span class="p">,</span> <span class="mi">1</span><span
            class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span
            class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span
            class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span
            class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span
            class="n">weapon_type</span><span class="o">=</span><span class="s2">&quot;Red Tome&quot;</span><span
            class="p">,</span> <span class="n">weapon</span><span class="o">=</span><span class="n">weapons</span><span
            class="p">[</span><span class="s2">&quot;fire&quot;</span><span class="p">])</span>

    <span class="n">Gob</span> <span class="o">=</span> <span class="n">Enemy</span><span class="p">(</span><span
            class="s2">&quot;Gobby&quot;</span><span class="p">,</span> <span class="mi">5</span><span
            class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span
            class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span
            class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span
            class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span
            class="n">weapon</span><span class="o">=</span><span class="n">weapons</span><span class="p">[</span><span
            class="s2">&quot;iron-sword&quot;</span><span class="p">])</span>

    <span class="n">Abel</span> <span class="o">=</span> <span class="n">Character</span><span class="o">.</span><span
            class="n">create_from_json</span><span class="p">(</span><span
            class="s2">&quot;abel-the-panther&quot;</span><span class="p">)</span>

    <span class="n">Char</span><span class="o">.</span><span class="n">move_to_attack</span><span
            class="p">(</span><span class="n">Gob</span><span class="p">)</span>

    <span class="n">Char</span><span class="o">.</span><span class="n">move_towards</span><span class="p">(</span><span
            class="n">Gob</span><span class="p">)</span>
    <span class="n">Char</span><span class="o">.</span><span class="n">move_towards</span><span class="p">(</span><span
            class="n">Gob</span><span class="p">)</span>
    <span class="n">Char</span><span class="o">.</span><span class="n">move_towards</span><span class="p">(</span><span
            class="n">Gob</span><span class="p">)</span>
    <span class="n">Char</span><span class="o">.</span><span class="n">move_towards</span><span class="p">(</span><span
            class="n">Gob</span><span class="p">)</span>
    <span class="n">Gob</span><span class="o">.</span><span class="n">move_towards</span><span class="p">(</span><span
            class="n">Char</span><span class="p">)</span>

    <span class="n">Char</span><span class="o">.</span><span class="n">move_to_attack</span><span
            class="p">(</span><span class="n">Gob</span><span class="p">)</span>

    <span class="k">pass</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span
                                class="p">:</span>
    <span class="n">program_instructions</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Program execution complete; terminating process&quot;</span><span
                                class="p">)</span>
</pre>
                        </div>

                    </div>

                </div>
                <footer>


                    <hr/>

                    <div role="contentinfo">
                        <p>

                            &copy; Copyright 2020, Dania M.

                        </p>
                    </div>


                    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a

                    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>

                    provided by <a href="https://readthedocs.org">Read the Docs</a>.

                </footer>

            </div>
        </div>

    </section>

</div>


<script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });

</script>


</body>
</html>